<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Catatan Penjualan & Pengeluaran</title>
<style>
  /* Reset and base */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 1rem;
    color: #333;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    color: #0077cc;
    margin-bottom: 1rem;
    font-weight: 700;
    text-align: center;
  }
  h2 {
    color: #005499;
    margin-top: 2rem;
    margin-bottom: 1rem;
    font-weight: 600;
    font-size: 1.25rem;
  }
  form {
    background: #fff;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 350px;
    margin-bottom: 1rem;
  }
  form .form-group {
    margin-bottom: 0.75rem;
  }
  label {
    display: block;
    font-weight: 600;
    margin-bottom: 0.25rem;
    font-size: 0.9rem;
  }
  input[type="text"],
  input[type="number"],
  input[type="date"] {
    width: 100%;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 1rem;
    transition: border-color 0.3s;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="date"]:focus {
    border-color: #0077cc;
    outline: none;
  }
  button {
    cursor: pointer;
    background: #0077cc;
    color: white;
    border: none;
    padding: 0.6rem 1.2rem;
    border-radius: 6px;
    font-size: 1rem;
    font-weight: 600;
    transition: background-color 0.3s;
    width: 100%;
  }
  button:hover {
    background: #005fa3;
  }
  table {
    border-collapse: collapse;
    width: 100%;
    max-width: 350px;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    margin-bottom: 1rem;
  }
  thead {
    background-color: #0077cc;
    color: white;
  }
  thead.expenditure {
    background-color: #cc3300;
  }
  th, td {
    padding: 0.6rem 0.8rem;
    text-align: left;
    font-size: 0.9rem;
    border-bottom: 1px solid #dee2e6;
  }
  tbody tr:last-child td {
    border-bottom: none;
  }
  .right {
    text-align: right;
  }
  .delete-btn {
    background: transparent;
    border: none;
    color: #dc3545;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
  }
  .delete-btn:hover {
    color: #a71d2a;
  }
  tfoot {
    font-weight: 700;
    background: #e9ecef;
  }
  .summary {
    width: 100%;
    max-width: 350px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    padding: 1rem;
    font-size: 1rem;
    margin-bottom: 2rem;
    display: flex;
    justify-content: space-between;
    color: #333;
  }
  .summary div {
    min-width: 30%;
    text-align: center;
  }
  .summary div span.amount {
    display: block;
    font-weight: 700;
    font-size: 1.2rem;
    margin-top: 0.25rem;
  }
  .summary div.total {
    color: #0077cc;
  }
  .summary div.expenditure {
    color: #cc3300;
  }
  .summary div.balance {
    color: #2a7a2a;
  }
  @media (max-width: 400px) {
    body {
      padding: 0.5rem;
    }
    form, table, .summary {
      max-width: 100%;
    }
    th, td {
      font-size: 0.8rem;
      padding: 0.4rem 0.5rem;
    }
    button {
      font-size: 0.9rem;
      padding: 0.5rem;
    }
    .summary {
      flex-direction: column;
      gap: 0.5rem;
    }
  }
</style>
</head>
<body>
<h1>Catatan Penjualan & Pengeluaran</h1>

<!-- Sales Section -->
<h2>Penjualan</h2>
<form id="sales-form" aria-label="Form tambah catatan penjualan">
  <div class="form-group">
    <label for="sales-date">Tanggal</label>
    <input type="date" id="sales-date" required />
  </div>
  <div class="form-group">
    <label for="item">Nama Barang</label>
    <input type="text" id="item" placeholder="Nama barang" required />
  </div>
  <div class="form-group">
    <label for="quantity">Jumlah</label>
    <input type="number" id="quantity" min="1" value="1" required />
  </div>
  <div class="form-group">
    <label for="price">Harga Satuan (Rp)</label>
    <input type="number" id="price" min="0" step="100" value="0" required />
  </div>
  <button type="submit">Tambah Catatan</button>
</form>

<table aria-label="Daftar Catatan Penjualan">
  <thead>
    <tr>
      <th>Tanggal</th>
      <th>Barang</th>
      <th class="right">Jumlah</th>
      <th class="right">Harga Satuan (Rp)</th>
      <th class="right">Total (Rp)</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody id="sales-list"></tbody>
  <tfoot>
    <tr>
      <td colspan="4" class="right">Total Penjualan</td>
      <td class="right" id="total-sales">0</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<!-- Expenditure Section -->
<h2>Pengeluaran</h2>
<form id="expense-form" aria-label="Form tambah catatan pengeluaran">
  <div class="form-group">
    <label for="expense-date">Tanggal</label>
    <input type="date" id="expense-date" required />
  </div>
  <div class="form-group">
    <label for="expense-desc">Keterangan</label>
    <input type="text" id="expense-desc" placeholder="Keterangan pengeluaran" required />
  </div>
  <div class="form-group">
    <label for="expense-amount">Jumlah Pengeluaran (Rp)</label>
    <input type="number" id="expense-amount" min="0" step="100" value="0" required />
  </div>
  <button type="submit">Tambah Pengeluaran</button>
</form>

<table aria-label="Daftar Catatan Pengeluaran">
  <thead class="expenditure">
    <tr>
      <th>Tanggal</th>
      <th>Keterangan</th>
      <th class="right">Jumlah (Rp)</th>
      <th>Aksi</th>
    </tr>
  </thead>
  <tbody id="expense-list"></tbody>
  <tfoot>
    <tr>
      <td colspan="2" class="right">Total Pengeluaran</td>
      <td class="right" id="total-expense">0</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<!-- Summary Section -->
<div class="summary" aria-label="Ringkasan penjualan dan pengeluaran">
  <div class="total">
    <div>Total Penjualan</div>
    <span class="amount" id="summary-sales">Rp0</span>
  </div>
  <div class="expenditure">
    <div>Total Pengeluaran</div>
    <span class="amount" id="summary-expense">Rp0</span>
  </div>
  <div class="balance">
    <div>Saldo Bersih</div>
    <span class="amount" id="summary-balance">Rp0</span>
  </div>
</div>

<script>
  // Sales elements
  const salesForm = document.getElementById('sales-form');
  const salesList = document.getElementById('sales-list');
  const totalSalesEl = document.getElementById('total-sales');
  const salesDateInput = document.getElementById('sales-date');
  const itemInput = document.getElementById('item');
  const quantityInput = document.getElementById('quantity');
  const priceInput = document.getElementById('price');

  // Expense elements
  const expenseForm = document.getElementById('expense-form');
  const expenseList = document.getElementById('expense-list');
  const totalExpenseEl = document.getElementById('total-expense');
  const expenseDateInput = document.getElementById('expense-date');
  const expenseDescInput = document.getElementById('expense-desc');
  const expenseAmountInput = document.getElementById('expense-amount');

  // Summary elements
  const summarySalesEl = document.getElementById('summary-sales');
  const summaryExpenseEl = document.getElementById('summary-expense');
  const summaryBalanceEl = document.getElementById('summary-balance');

  let salesNotes = [];
  let expenses = [];

  // Load from localStorage
  function loadData() {
    const salesData = localStorage.getItem('salesNotes');
    const expenseData = localStorage.getItem('expenses');
    salesNotes = salesData ? JSON.parse(salesData) : [];
    expenses = expenseData ? JSON.parse(expenseData) : [];
  }

  // Save to localStorage
  function saveData() {
    localStorage.setItem('salesNotes', JSON.stringify(salesNotes));
    localStorage.setItem('expenses', JSON.stringify(expenses));
  }

  // Format number as IDR currency (without decimals)
  function formatCurrency(num) {
    return num.toLocaleString('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 });
  }

  // Render sales notes in table
  function renderSales() {
    salesList.innerHTML = '';
    let total = 0;
    salesNotes.forEach((note, index) => {
      const totalPerNote = note.quantity * note.price;
      total += totalPerNote;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${note.date}</td>
        <td>${note.item}</td>
        <td class="right">${note.quantity}</td>
        <td class="right">${formatCurrency(note.price)}</td>
        <td class="right">${formatCurrency(totalPerNote)}</td>
        <td class="right"><button class="delete-btn" aria-label="Hapus catatan penjualan" data-index="${index}" data-type="sales">&times;</button></td>
      `;
      salesList.appendChild(tr);
    });
    totalSalesEl.textContent = formatCurrency(total);
    summarySalesEl.textContent = formatCurrency(total);
  }

  // Render expenses in table
  function renderExpenses() {
    expenseList.innerHTML = '';
    let total = 0;
    expenses.forEach((exp, index) => {
      total += exp.amount;
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${exp.date}</td>
        <td>${exp.description}</td>
        <td class="right">${formatCurrency(exp.amount)}</td>
        <td class="right"><button class="delete-btn" aria-label="Hapus catatan pengeluaran" data-index="${index}" data-type="expense">&times;</button></td>
      `;
      expenseList.appendChild(tr);
    });
    totalExpenseEl.textContent = formatCurrency(total);
    summaryExpenseEl.textContent = formatCurrency(total);
  }

  // Update balance summary
  function updateBalance() {
    const totalSales = salesNotes.reduce((acc, cur) => acc + cur.quantity * cur.price, 0);
    const totalExpenses = expenses.reduce((acc, cur) => acc + cur.amount, 0);
    const balance = totalSales - totalExpenses;
    summaryBalanceEl.textContent = formatCurrency(balance);
  }

  // Add new sales note from form
  salesForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const date = salesDateInput.value;
    const item = itemInput.value.trim();
    const quantity = parseInt(quantityInput.value);
    const price = parseInt(priceInput.value);

    if (!date || !item || quantity < 1 || price < 0) {
      alert('Mohon isi semua data penjualan dengan benar.');
      return;
    }

    salesNotes.push({ date, item, quantity, price });
    saveData();
    renderSales();
    updateBalance();

    salesForm.reset();
    // Set date back to today for convenience
    const today = new Date().toISOString().substr(0, 10);
    salesDateInput.value = today;
    quantityInput.value = 1;
    priceInput.value = 0;
    itemInput.focus();
  });

  // Add new expense from form
  expenseForm.addEventListener('submit', function(e) {
    e.preventDefault();
    const date = expenseDateInput.value;
    const description = expenseDescInput.value.trim();
    const amount = parseInt(expenseAmountInput.value);

    if (!date || !description || amount < 0) {
      alert('Mohon isi semua data pengeluaran dengan benar.');
      return;
    }

    expenses.push({ date, description, amount });
    saveData();
    renderExpenses();
    updateBalance();

    expenseForm.reset();
    // Set date back to today for convenience
    const today = new Date().toISOString().substr(0, 10);
    expenseDateInput.value = today;
    expenseAmountInput.value = 0;
    expenseDescInput.focus();
  });

  // Handle delete button clicks for sales and expenses
  document.body.addEventListener('click', e => {
    if (e.target.classList.contains('delete-btn')) {
      const index = parseInt(e.target.getAttribute('data-index'));
      const type = e.target.getAttribute('data-type');
      if (index >= 0 && (type === 'sales' || type === 'expense')) {
        if (confirm('Yakin ingin menghapus catatan ini?')) {
          if (type === 'sales') {
            salesNotes.splice(index, 1);
          } else if (type === 'expense') {
            expenses.splice(index, 1);
          }
          saveData();
          renderSales();
          renderExpenses();
          updateBalance();
        }
      }
    }
  });

  // Initialize on load
  function init() {
    loadData();
    renderSales();
    renderExpenses();
    updateBalance();
    // Set default dates to today
    const today = new Date().toISOString().substr(0, 10);
    salesDateInput.value = today;
    expenseDateInput.value = today;
  }

  init();
</script>
</body>
</html>

